<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Open ATBP is a multiplayer online battle arena (MOBA) game based on the Adventure Time series. It features 19 unique Champions and intense 3v3 sessions where teams battle to destroy the enemy base.">
    <meta name="keywords" content="Open ATBP, MOBA game, Adventure Time, multiplayer online battle arena, 3v3 game, Champions, game release, video game, Adventure Time Battle Party">
    <meta property="og:title" content="Open ATBP - Multiplayer MOBA Game Based on Adventure Time">
    <meta property="og:description" content="Play Open ATBP, a thrilling MOBA game inspired by Adventure Time. Control one of 19 unique Champions in intense 3v3 battles.">
    <meta property="og:image" content="atbp-bee.png">
    <meta property="og:url" content="https://www.openatbp.xyz/spicybattle.html">
    <meta property="og:type" content="website">
    <meta name="robots" content="index, follow">
    <title>OpenATBP Spicy Battle</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="img/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <style>
        #spicy-battle-menu {
            display: flex;
            justify-content: center;
            margin: 1em 0 1em 0;
            font-size: 1.5em;

        }

        #spicy-battle-menu div {
            margin-right: 1em;
            transition: color 0.3s;
        }

        #global-stats-btn,
        #player-search-btn {
            color: grey;
        }

        #leaderboard-btn {
            color: white;
        }

        #spicy-battle-menu div:hover {
            color: white;
        }

        #spicy-battle-menu .active {
            color: white;
            cursor: default;
        }

        #spicy-battle-menu .inactive {
            color: grey;
            cursor: pointer;
        }

        table {
            width: 30%;
            border-collapse: collapse;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            background-color: rgba(21, 45, 82, 0.2);
            margin: auto;
            overflow: hidden;
            color: white;
        }

        tr {
            transition: background-color 0.3s;
        }

        tr:hover {
            background-color: #122642;
            cursor: pointer;
        }

        td {
            padding: 10px;
            text-align: center;
        }

        .bottom-border-cell {
            border-bottom: 1px solid #ddd;
        }

        .profile-picture {
            height: 8vh;
            width: auto;
            border-radius: 50%;
        }

        .rank-image {
            height: 7vh;
            width: auto;
        }

        .leaderboard-position {
            font-weight: bold;
            font-size: 2em;
        }

        .purple-border {
            border-bottom: 2px solid #e600ff;
        }

        .teal-border {
            border-bottom: 2px solid #29dddd;
        }

        .gold-border {
            border-bottom: 2px solid #ffe504;
        }

        .silver-border {
            border-bottom: 2px solid #81acdc;
        }

        .bronze-border {
            border-bottom: 2px solid #ffa900;
        }

        .master-border {
            border-bottom: 2px solid #7b286b;
        }

        .royal-border {
            border-bottom: 2px solid #42c2d9;
        }

        .regular-border {
            border-bottom: 2px solid white;
        }

        .purple {
            color: transparent;
            -webkit-text-stroke: 1px #e600ff;
        }

        .teal {
            color: transparent;
            -webkit-text-stroke: 1px #29dddd;
        }

        .gold {
            color: transparent;
            -webkit-text-stroke: 1px #ffe504;
        }

        .silver {
            color: transparent;
            -webkit-text-stroke: 1px #81acdc;
        }

        .bronze {
            color: transparent;
            -webkit-text-stroke: 1px #ffa900;
        }

        .master {
            color: transparent;
            -webkit-text-stroke: 1px #7b286b;
        }

        .royal {
            color: transparent;
            -webkit-text-stroke: 1px #42c2d9;
        }

        #page-header {
            text-align: center;
            color: white;
        }

        #page-header h1 {
            margin-bottom: 0;
        }

        #page-header p {
            margin-top: 0.5em;
        }

        #global-stats-section {
            color: white;
            text-align: center;
            display: none;
        }

        #player-search-section {
            color: white;
            text-align: center;
            display: none;
        }
    </style>
</head>
<body>
    <div id="navigation">
        <a href="https://www.reddit.com/r/battleparty/" target="_blank"><img src="img/reddit.png" alt="r/battleparty" id="reddit-link-img"></a>
        <img src="img/atbp-bee.png" id="nav-logo" alt="Open ATBP Logo">
        <img src="img/menu.png" alt="menu" id="mobile-nav-open-btn">
        <div id="mobile-nav">
            <table>
                <tr>
                    <td><img src="img/close.png" alt="close" id="mobile-nav-close"></td>
                </tr>
                <tr>
                    <td><a href="index.html">DOWNLOAD</a></td>
                </tr>
                <tr>
                    <td><a href="notes.html">PATCH NOTES</a></td>
                </tr>
                <tr>
                    <td><a href="wiki-home.html">WIKI</a></td>
                </tr>
                <tr>
                    <td><a target="_blank" href="https://discord.gg/YzJkPDjZxG">DISCORD SERVER</a></td>
                </tr>
                <tr>
                    <td><a target="_blank" href="https://github.com/OpenATBP/OpenATBP">GITHUB</a></td>
                </tr>
            </table>
        </div>
        <div id="desktop-nav">
            <a class="navigation-a" href="index.html">DOWNLOAD</a>
            <a class="navigation-a" href="notes.html">PATCH NOTES</a>
            <a class="navigation-a" href="wiki-home.html">WIKI</a>
            <a class="navigation-a" target="_blank" href="https://discord.gg/YzJkPDjZxG">DISCORD SERVER</a>
            <a class="navigation-a" target="_blank" href="https://github.com/OpenATBP/OpenATBP">GITHUB</a>
        </div>
    </div>
    <div id="page-header">
        <h1>Spicy Battle</h1>
    </div>
    <div id="spicy-battle-menu">
        <div id="leaderboard-btn">Leaderboard</div>
        <div id="global-stats-btn" class="inactive">Global Stats</div>
        <div id="player-search-btn" class="inactive">Player Search</div>
    </div>
    <div id="leaderboard-section"></div>
    <div id="global-stats-section"><h1>Coming soon™</h1></div>
    <div id="player-search-section"><h1>Coming soon™</h1></div>
    <script>
        function getTop50Border(elo) {
            if (elo > 2433) return 'purple-border';
            else if (elo > 2225) return 'teal-border';
            else if (elo > 2017) return 'gold-border';
            else if (elo > 1809) return 'silver-border';
            else if (elo > 1600) return 'bronze-border';
            else if (elo > 1348) return 'master-border';
            else if (elo > 1147) return 'royal-border';
        }

        function getTop50NumberColor(elo) {
            if (elo > 2433) return 'purple';
            else if (elo > 2225) return 'teal';
            else if (elo > 2017) return 'gold';
            else if (elo > 1809) return 'silver';
            else if (elo > 1600) return 'bronze';
            else if (elo > 1348) return 'master';
            else if (elo > 1147) return 'royal';
        }

        function getRankImage(elo) {
            if (elo > 2433) return 'img/ranks/4-4.png';
            else if (elo > 2225) return 'img/ranks/4-3.png';
            else if (elo > 2017) return 'img/ranks/4-2.png';
            else if (elo > 1809) return 'img/ranks/4-1.png';
            else if (elo > 1600) return 'img/ranks/4-0.png';
            else if (elo > 1538) return 'img/ranks/3-3.png';
            else if (elo > 1475) return 'img/ranks/3-2.png';
            else if (elo > 1412) return 'img/ranks/3-1.png';
            else if (elo > 1348) return 'img/ranks/3-0.png';
            else if (elo > 1282) return 'img/ranks/2-2.png';
            else if (elo > 1215) return 'img/ranks/2-1.png';
            else if (elo > 1147) return 'img/ranks/2-0.png';
            else if (elo > 573) return 'img/ranks/1-1.png';
            else return 'img/ranks/1-0.png';
        }

        async function displayLeaderboard() {
            try {
                const res = await fetch('https://beta.openatbp.xyz/data/rankings');
                const data = await res.json();

                if (data.length > 0) {
                    const leaderboardSection = document.getElementById('leaderboard-section');
                    if (leaderboardSection) {
                        const table = document.createElement('table');

                        data.forEach((object, index, array) => {
                            let elo = object.player.elo;
                            let dname = object.user.dname;

                            let row = document.createElement('tr'); 

                            let numberCell = document.createElement('td');
                            numberCell.textContent = index + 1;
                            numberCell.className = 'leaderboard-position';

                            let imageCell = document.createElement('td');
                            let profilePicture = document.createElement('img');
                            profilePicture.setAttribute('src', 'img/profile-icons/180x180_profile_generic.jpg'); // default profile image until actual pfps are implemented
                            profilePicture.className = 'profile-picture';
                            imageCell.appendChild(profilePicture);

                            let nameCell = document.createElement('td');
                            dname.split(' ').forEach((word, index, array) => {
                                nameCell.appendChild(document.createTextNode(word));
                                if (index < array.length - 1) {
                                    nameCell.appendChild(document.createElement('br'));
                                }
                            });

                            let eloCell = document.createElement('td');
                            eloCell.textContent = elo;

                            let rankImageCell = document.createElement('td');
                            let rankImage = document.createElement('img');

                            rankImage.setAttribute('src', getRankImage(elo));
                            rankImage.className = 'rank-image';
                            rankImageCell.appendChild(rankImage);

                            // styling based on position
                            let position = index + 1;
                            let borderName = 'regular-border';
                            if (position < 51) {
                                borderName = getTop50Border(elo);
                                numberCell.classList.add(getTop50NumberColor(elo));
                            }
                            row.className = borderName;
                            
                            row.appendChild(numberCell);
                            row.appendChild(imageCell);
                            row.appendChild(nameCell);
                            row.appendChild(eloCell);
                            row.appendChild(rankImageCell);

                            table.appendChild(row);
                        });
                        leaderboardSection.appendChild(table);
                    }
                }
            } catch (error) {
                console.log(error);
            }
        }

        async function displayGlobalStats() {
            
        }

        document.addEventListener('DOMContentLoaded', function () {
            const buttons = document.querySelectorAll('#spicy-battle-menu div');
            const sections = document.querySelectorAll('[id$="-section"]'); // Select all sections ending with "-section"

            buttons.forEach(button => {
                button.addEventListener('click', function () {
                    // If the clicked button is already active, do nothing
                    if (this.classList.contains('active')) return;

                    // Remove 'active' class from all buttons and add 'inactive'
                    buttons.forEach(btn => {
                        btn.classList.remove('active');
                        btn.classList.add('inactive');
                    });

                    // Add 'active' class to the clicked button and remove 'inactive'
                    this.classList.add('active');
                    this.classList.remove('inactive');

                    // Get the button's id and corresponding section
                    const btnId = this.id;
                    const sectionId = btnId.split('-btn')[0] + '-section';
                    const clickedSection = document.getElementById(sectionId);

                    // hide all inactive sections
                    sections.forEach(section => {
                        section.style.display = 'none';
                    })

                    // display active section after the button was clicked
                    if (clickedSection) {
                        clickedSection.style.display = 'block';
                        // if (sectionId === 'global-stats-section') displayGlobalStats();
                    }
                });
            });
        });
        displayLeaderboard()
    </script>
    <script type="text/javascript" src="mobile-nav-handler.js" ></script>
</body>
</html>
